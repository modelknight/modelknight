rules:
- id: block-jailbreak-keywords
  description: Block obvious jailbreak attempts
  applies_to: prompt
  action: block
  priority: 1
  when:
    any:
    - type: keywords
      field: text
      values:
      - ignore previous instructions
      - reveal system prompt
- id: block-cc-response
  description: Block credit-card-like digits in responses
  applies_to: response
  action: block
  priority: 5
  when:
    any:
    - type: regex
      field: text
      pattern: \b\d{13,19}\b
pii:
  enabled: true
  applies_to: both
  mode: redact
  redaction_token: REDACTED
  detectors:
    email: true
    ip: true
    credit_card: true
    phone: true
  max_bytes: 32768
  include_findings: false
semantic:
  enabled: true
  applies_to: prompt
  action: block
  threshold: 0.3
  cases:
  - id: jailbreak
    description: Jailbreak-like prompts
    examples:
    - text: override safety mechanisms
      embedding: null
    - text: work around safety restrictions
      embedding: null
    - text: bypass safety policies
      embedding: null
  ngram_min: 4
  ngram_max: 6
